# 웹 애플리케이션 컨테이너

웹 애플리케이션 컨테이너(Web Application Container)란, 웹 애플리케이션이 배포되는 공간을

말한다.

일반적으로 HTML과 같은 정적 파일들을 전달해 주는 역할을 하는 서버를 웹 서버(Web Server)라고

하며 PHP, JSP, ASP와 같은 언어들을 사용해서 동적인 페이지들을 생성 가능한 서버를 웹 애플리

케이션 서버(Web Application Server) 또는 자바 계열에서는 웹 애플리케이션 컨테이너라고 한다.

일반적으로 WAS로 줄여서 부르기도 한다. WAS가 어떻게 웹 에플리케이션을 인식하고 동작시키는

지 알기 위해서는 클래스 로더를 아는 것이 중요하다.

# 클래스 로더

자바의 특징 중 대표적인 것이 “한번 작성하면 플랫폼에 상관없이 쓸 수 있다.” 라는 특징인데

이 특징을 실행할 수 있게 한 기술이 바로 클래스 로더(class loader)다. 자바 코드를 작성한 후 

컴파일하면 해당 코드는 JVM(Java Virtual Machine)에서 실행 가능한 상태가 된다.

이때 JVM이 클래스를 실행하기 위해서는 클래스를 로딩하는 과정이 필요한데 그 과정을 수행해

주는 역할을 하는 것이 클래스 로더이다.

다른 사람이 만든 프로젝트를 로컬에서 실행할 때 ClassNotFoundException와 같은 에러가 발생 

한다면 해당 에러는 클래스 로더가 추가된 라이브러리 또는 클래스를 인식하지 못해서 발생하는 

오류이다.

클래스패스(classpath)에 해당 모듈 또는 라이브러리를 추가하여 에러를 해결할 수 있으며 

클래스패스(classpath)에 추가되면 클래스 로더는 식별자로 클래스파일 메타 정보 중 첫번째

시작 필드를 이용해 클래스를 로딩한다. 

## 클래스 로더의 4가지 특징

- 구조가 계층 적이다. 
(상위 클래스 로더에서 하위 클래스 로더를 갖는 방식이며, 최상위 클래스 로더는 부트스트랩 
 클래스 로더이다.)

- 클래스 로딩을 위임할 수 있다.

- 클래스 로더는 가시적인 규약이 있다.
    
    (가시적인 규약이란, 클래스를 로딩할 때 가능한 범위를 말한다. 자식 클래스 로더는 클래스
     로딩 요청 위임을 통해 부모 클래스 로더가 로딩한 클래스를 찾을 수 있지만, 부모 클래스로더는
    
     자식 클래스 로더가 로딩한 클래스를 알 수 없다.)
    
     
    
- 클래스 언로딩 불가능
(클래스 로더로 로딩한 클래스들을 언로딩할 수 없다. 클래스 로더가 로딩한 클래스를 언로딩할
    
     수 없으므로 가비지 컬렉터(garbage collector)가 동작하거나 WAS가 재식할 때 초기화된다.)
    
    ## 클래스 로더의 4가지 유형
    
    - 부트스트랩 클래스 로더(bootstrap class loader)
        
        (JVM 런타임 실행을 위해 기반이 되는 파일들을 로드한다. 부트스트랩 로더는 rt.jar
        
        파일과 연관이 있다.)
        
    - 확장 클래스 로더(extension class loader)
        
        (부트스트랩 로더가 로딩이 끝나면 확장 클래스 로더가 자바 최상위 객체인 Object를 포함한 
        
        자바 API를 로드한다.(자바 홈 폴더 하위의 ext 폴더 하위에 있는 JAR 파일들과 연관이 있다.)
        
         
        
    - 시스템 클래스 로더(system class loader)
        
        (확장 로더의 로드가 끝나면 시스템 클래스 로더가 클래스 패스에 포함된 클래스들을 로드
        
        한다.)
        
    - 사용자 정의 클래스 로더(user - defined class loader)
    
    ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/ea204791-94b0-4594-95e9-37705edf8245/b2f892bf-fdb7-4d25-8cf0-36caf0e43c5e/Untitled.png)
    
    클래스 로더는 이와 같은 계층 관계를 가지고 있다. 사용자는 시스템 클래스 로더가 로드하는 
    
    클래스 패스 영역에만 접근할 수 있다. 그래서 로컬에서 외부 라이브러리를 실행할 때 클래스
    
    패스를 지정해서 실행하기도 한다. 보통 독립적인 영역이 필요한 WAS의 경우에는 시스템 
    
    클래스 로더 하위에 사용자 정의 로더를 만들어서 사용한다. 
    
    대부분의 개발 환경 설정 관련 문서에서 톰캣 설치 위치를 CATALINA_HOME으로 지정하는 것은
    
    WAS에서 생성한 클래스 로더를 기준으로 동작하기 위함이다.